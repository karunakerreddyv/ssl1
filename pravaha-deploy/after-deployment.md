# After Deployment Checklist - Single Server

This checklist helps verify your Pravaha Platform deployment is working correctly.

**Deployment Type:** Single Server (All-in-One)
**Configuration:** `/opt/pravaha/.env`

---

## Immediate Verification

Run these commands to verify all services are healthy:

```bash
# Check all services are running and healthy
cd /opt/pravaha
docker compose ps

# Expected: All services should show "healthy" status
```

### Health Check Endpoints

```bash
# Test NGINX health
curl -k https://your-domain.example.com/health

# Test Backend API health
curl -k https://your-domain.example.com/api/v1/health

# Test ML Service health
curl -k https://your-domain.example.com/ml/api/v1/health

# Test Superset health
curl -k https://your-domain.example.com/insights/health
```

All endpoints should return `200 OK`.

---

## Login Verification

- [ ] Access `https://your-domain.example.com` in browser
- [ ] Accept SSL certificate warning (if self-signed)
- [ ] Login with generated admin credentials (see credential files in deployment directory):
  - **Email:** See `.admin_email` file (`cat /opt/pravaha/.admin_email`)
  - **Password:** See `.admin_password` file (`cat /opt/pravaha/.admin_password`)
- [ ] Change admin password immediately after first login
- [ ] Delete credential files after saving: `rm /opt/pravaha/.admin_email /opt/pravaha/.admin_password`
- [ ] Verify dashboard loads without errors
- [ ] Test creating a new project or workflow
- [ ] Verify Superset/Insights page loads

---

## Security Keys Generated

The following secrets were auto-generated by install.sh. Review in `.env`:

- [ ] `JWT_SECRET` - JSON Web Token signing key
- [ ] `SUPERSET_SECRET_KEY` - Superset encryption key
- [ ] `ENCRYPTION_KEY` - General encryption key (32 hex chars)
- [ ] `POSTGRES_PASSWORD` - Database password
- [ ] `ML_SERVICE_API_KEY` - ML service authentication
- [ ] `CREDENTIAL_MASTER_KEY` - Credential encryption master key
- [ ] `DATA_ENCRYPTION_KEY` - Data encryption key
- [ ] `EXCEPTION_ENCRYPTION_KEY` - Exception data encryption key
- [ ] `HMAC_SECRET` - Request signing key
- [ ] `AUDIT_SIGNATURE_SECRET` - Audit log integrity key
- [ ] `MODEL_SIGNING_KEY` - ML model signing key
- [ ] `ML_SERVICE_HMAC_SECRET` - ML service request signing key
- [ ] `ML_CREDENTIAL_ENCRYPTION_KEY` - ML credential encryption (Fernet key)
- [ ] `INTERNAL_SERVICE_KEY` - Internal service-to-service authentication
- [ ] `CCM_ENCRYPTION_KEY` - Compliance controls module encryption
- [ ] `STORAGE_ENCRYPTION_KEY` - CCM storage provider credential encryption
- [ ] `EVIDENCE_HMAC_SECRET` - Evidence file integrity signatures
- [ ] `LINEAGE_SIGNATURE_SECRET` - Data lineage signature key
- [ ] `SESSION_SECRET` - Session management key
- [ ] `CSRF_SECRET` - CSRF protection key
- [ ] `REDIS_PASSWORD` - Redis authentication password
- [ ] `SUPERSET_ADMIN_PASSWORD` - Superset admin account password
- [ ] `JUPYTER_TOKEN` - Jupyter Notebook access token
- [ ] `SUPER_ADMIN_JWT_SECRET` - Super admin JWT signing key

---

## Production Security Checklist

- [ ] Replace self-signed SSL certificate with valid CA certificate
- [ ] Change default admin passwords for all users
- [ ] Review and restrict firewall rules (only 80, 443 needed)
- [ ] Disable ENABLE_SWAGGER_DOCS in production
- [ ] Configure backup schedule for database and models
- [ ] Set up monitoring and alerting (Slack/Teams webhooks)
- [ ] Review CORS_ORIGIN and ALLOWED_ORIGINS settings
- [ ] Ensure AI_MOCK_MODE is appropriate for your use case

---

## Optional Services

### Jupyter Notebook Server
Jupyter is included as a core service and starts automatically with `docker compose up -d`.
Access notebooks at: `https://<domain>/notebooks/`
Jupyter token: stored in `.env` file (`JUPYTER_TOKEN`)

### Grafana Logging Stack
```bash
cd /opt/pravaha
docker compose -f docker-compose.yml -f docker-compose.logging.yml up -d

# Access at https://your-domain.example.com/logs/
# Default credentials in .env: GRAFANA_ADMIN_USER, GRAFANA_ADMIN_PASSWORD
```

---

## Backup Configuration

### Database Backup
```bash
# Manual backup
docker compose exec postgres pg_dump -U pravaha autoanalytics > backup-$(date +%Y%m%d).sql

# Automated backup (add to crontab)
0 2 * * * cd /opt/pravaha && docker compose exec -T postgres pg_dump -U pravaha autoanalytics > /opt/pravaha/backups/db-$(date +\%Y\%m\%d).sql
```

### Model Storage Backup
```bash
# Backup ML models volume
docker run --rm -v pravaha_ml_models:/data -v /opt/pravaha/backups:/backup alpine tar cvf /backup/models-$(date +%Y%m%d).tar /data
```

---

## Monitoring Setup

### Log Viewing
```bash
# View all logs
docker compose logs -f

# View specific service logs
docker compose logs -f backend
docker compose logs -f ml-service
docker compose logs -f celery-worker-training
```

### Set Up Alerting
Configure webhooks in `.env`:
```ini
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/...
PAGERDUTY_ROUTING_KEY=...
```

---

## Common Operations

### Restart Services
```bash
docker compose restart
```

### Update Images
```bash
docker compose pull
docker compose up -d
```

### View Container Status
```bash
docker compose ps
```

### Enter Container Shell
```bash
docker compose exec backend sh
docker compose exec postgres psql -U pravaha autoanalytics
```

### Clear Redis Cache
```bash
docker compose exec redis redis-cli FLUSHALL
```

---

## Troubleshooting

### Services Not Starting
```bash
docker compose logs
docker compose down
docker compose up -d
```

### Database Connection Issues
```bash
docker compose logs postgres
docker compose exec postgres pg_isready -U pravaha
```

### SSL Certificate Issues
```bash
# Check certificate validity
openssl x509 -in /opt/pravaha/ssl/fullchain.pem -text -noout

# Regenerate self-signed cert
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /opt/pravaha/ssl/privkey.pem \
  -out /opt/pravaha/ssl/fullchain.pem \
  -subj "/CN=your-domain.example.com/O=Pravaha/C=US"

docker compose restart nginx
```

---

## Support

- Configuration: `/opt/pravaha/.env`
- Logs: `docker compose logs`
- Issues: https://github.com/TalentFino/pravaha/issues

---

*Generated by Pravaha Platform Installer*
